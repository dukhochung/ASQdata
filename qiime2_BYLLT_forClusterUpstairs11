

qiime dada2 denoise-paired \
  --i-demultiplexed-seqs BYLLT-demux.qza \
  --o-table BYLLT-table.qza \
  --o-representative-sequences BYLLT-rep-seqs.qza \
  --o-denoising-stats BYLLT-denoising-stats.qza \
  --p-trim-left-f 20 \
  --p-trim-left-r 0 \
  --p-trunc-len-f 285 \
  --p-trunc-len-r 255 \
  --p-n-threads 10 \
  --p-n-reads-learn 1000000 \
#  --output-dir dada2_output



# The feature-table summarize command will give you information on how many sequences are associated with each sample and with each feature, histograms of those distributions, and some related summary statistics.
qiime feature-table summarize \
  --i-table BYLLT-table.qza \
  --o-visualization BYLLT-table.qzv \
  --m-sample-metadata-file BYLLT-metadata.tsv


# The feature-table tabulate-seqs command will provide a mapping of feature IDs to sequences, and provide links to easily BLAST each sequence against the NCBI nt database. The latter visualization will be very useful later in the tutorial, when you want to learn more about specific features that are important in the data set.
qiime feature-table tabulate-seqs \
  --i-data BYLLT-rep-seqs.qza \
  --o-visualization BYLLT-rep-seqs.qzv

qiime metadata tabulate \
  --m-input-file BYLLT-denoising-stats.qza \
  --o-visualization BYLLT-denoising-stats.qzv


qiime alignment mafft \
  --i-sequences BYLLT-rep-seqs.qza \
  --o-alignment BYLLT-aligned-rep-seqs.qza

qiime alignment mask \
  --i-alignment BYLLT-aligned-rep-seqs.qza \
  --o-masked-alignment BYLLT-masked-aligned-rep-seqs.qza

qiime phylogeny fasttree \
  --i-alignment BYLLT-masked-aligned-rep-seqs.qza \
  --o-tree BYLLT-unrooted-tree.qza

qiime phylogeny midpoint-root \
  --i-tree BYLLT-unrooted-tree.qza \
  --o-rooted-tree BYLLT-rooted-tree.qza




